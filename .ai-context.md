# AI Context & Guidelines

**Purpose:** This hidden file provides critical context for AI models working on this codebase.

**Last Updated:** January 15, 2026

---

## üö® CRITICAL: Read Before Making Any Changes

This codebase has **specific architectural patterns** that are easy to get wrong. Following this guide will prevent 95% of common errors.

---

## 1. Essential Reading (In Order)

1. **[`AI_DEVELOPER_GUIDE.md`](AI_DEVELOPER_GUIDE.md)** - 30-second quick reference (READ THIS FIRST!)
2. **[`ARCHITECTURE_PATTERNS.md`](ARCHITECTURE_PATTERNS.md)** - Comprehensive patterns guide
3. **[`FIXES_LOG.md`](FIXES_LOG.md)** - What was fixed and why
4. **[`LINTING_AND_BEST_PRACTICES.md`](LINTING_AND_BEST_PRACTICES.md)** - Code quality guidelines

---

## 2. Project-Specific Constraints

### ‚ö†Ô∏è Next.js 15 Breaking Changes

```typescript
// ‚ùå WRONG (Next.js 14 pattern)
export default function Page({ params }: PageProps) {
  const { slug } = params
}

// ‚úÖ CORRECT (Next.js 15 - Client Component)
"use client"
import { use } from "react"

export default function Page({ params }: PageProps) {
  const { slug } = use(params)
}
```

### ‚ö†Ô∏è Client Component Requirements

**ALWAYS add `"use client"` to:**
- Components that use React hooks (useState, useEffect, etc.)
- Components that receive ReactNode props with interactive elements
- Components that handle browser events (onClick, onChange, etc.)

**Critical files that MUST be Client Components:**
- `components/page-content.tsx` ‚úÖ
- `components/setup-status-panel.tsx` ‚úÖ
- `components/demo-panel.tsx` ‚úÖ
- `app/[...slug]/page.tsx` ‚úÖ
- `app/page.tsx` ‚úÖ

### ‚ö†Ô∏è Registry-Based Content System

**DO NOT create individual page files for documentation!**

Instead:
1. Add content to `content/pages-registry.ts`
2. Add navigation to `content/nav.ts`
3. The catch-all route (`app/[...slug]/page.tsx`) handles everything

**Critical: Registry data must be transformed:**

```typescript
// ‚ùå WRONG
return <PageContent pageData={pagesRegistry[path]} />

// ‚úÖ CORRECT
const pageData = pagesRegistry[path]
return (
  <PageContent
    title={pageData.title}
    description={pageData.description}
    status={pageData.badge}
    rightPanel={/* ... */}
  >
    {/* render section blocks */}
  </PageContent>
)
```

---

## 3. Common Patterns Used

### Pattern: Adding Documentation Pages

```typescript
// Step 1: content/pages-registry.ts
"/your-page": {
  title: "Your Title",
  description: "Your description",
  badge: "Stable",
  sectionBlocks: [
    {
      heading: "Section Title",
      body: "Content with **bold** and `code`"
    }
  ],
  showDemo: false
}

// Step 2: content/nav.ts
{
  title: "Your Page",
  href: "/your-page",
  icon: YourIcon,
  group: "Your Group"
}

// Step 3: Done! No page file needed.
```

### Pattern: Markdown in Section Bodies

Section bodies support simple markdown:

```typescript
// In registry:
body: "This is **bold** and `code`.\n\n```bash\nnpm install\n```"

// In page.tsx, parse it:
{section.body.split('\n\n').map((para, i) => {
  if (para.startsWith('```')) {
    // Handle code blocks
    return <pre><code>{extractCode(para)}</code></pre>
  }
  // Handle inline formatting
  return <div dangerouslySetInnerHTML={{
    __html: para
      .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
      .replace(/`([^`]+)`/g, '<code>$1</code>')
  }} />
})}
```

---

## 4. Critical Build-Breaking Issues

### üö® MOST COMMON ERROR: Unescaped Apostrophes

**‚ö†Ô∏è CRITICAL:** This works in dev but **BREAKS PRODUCTION BUILD!**

```jsx
// ‚ùå WRONG - Will break Vercel/production build
<p>What you'll learn</p>
<span>Meta's AI</span>
<div>Don't forget</div>

// ‚úÖ CORRECT - Replace ' with &apos;
<p>What you&apos;ll learn</p>
<span>Meta&apos;s AI</span>
<div>Don&apos;t forget</div>
```

**Common words that need escaping:**
- you'll ‚Üí you&apos;ll
- don't ‚Üí don&apos;t
- it's ‚Üí it&apos;s
- can't ‚Üí can&apos;t
- won't ‚Üí won&apos;t
- Meta's ‚Üí Meta&apos;s

**How to check:**
```bash
# Search for apostrophes in JSX
grep -rn ">[^<]*'[^']*<" app/ components/

# Or just run lint
npm run lint
```

---

### üö® SECOND MOST COMMON: Missing Hook Dependencies

```typescript
// ‚ùå WRONG - Function used but not in deps
const myFunc = () => { /* ... */ }

useEffect(() => {
  myFunc()  // Used here
}, [other])  // Missing myFunc!

// ‚úÖ CORRECT - Wrap in useCallback
const myFunc = useCallback(() => {
  /* ... */
}, [])

useEffect(() => {
  myFunc()
}, [other, myFunc])  // Include the function
```

---

## 5. What NOT To Do

### ‚ùå DON'T: Create Individual Page Files

```typescript
// ‚ùå WRONG - Don't create this:
app/problems/my-new-problem/page.tsx

// ‚úÖ CORRECT - Just update registry:
content/pages-registry.ts
```

### ‚ùå DON'T: Pass Registry Objects Directly

```typescript
// ‚ùå WRONG
<PageContent pageData={pagesRegistry[path]} />

// ‚úÖ CORRECT
<PageContent title={data.title} description={data.description} ... />
```

### ‚ùå DON'T: Forget "use client"

```typescript
// ‚ùå WRONG - Missing directive
import { useState } from "react"

export function MyComponent() {
  const [state, setState] = useState(0)
  return <button onClick={() => setState(1)}>Click</button>
}

// ‚úÖ CORRECT
"use client"

import { useState } from "react"

export function MyComponent() {
  const [state, setState] = useState(0)
  return <button onClick={() => setState(1)}>Click</button>
}
```

### ‚ùå DON'T: Use await in Client Components

```typescript
// ‚ùå WRONG - Client Component can't be async
"use client"

export default async function Page({ params }: PageProps) {
  const { slug } = await params  // ERROR!
}

// ‚úÖ CORRECT
"use client"
import { use } from "react"

export default function Page({ params }: PageProps) {
  const { slug } = use(params)  // React's use() hook
}
```

---

## 5. Error Messages & Solutions

### Error: "Event handlers cannot be passed to Client Component props"

**Solution:** Add `"use client"` to the component

### Error: "params.slug is not iterable"

**Solution:** Use `use(params)` instead of direct destructuring

### Error: "pageData is not a valid prop"

**Solution:** Transform registry data to individual props

---

## 6. Files You'll Commonly Edit

| File | Purpose | Type | Notes |
|------|---------|------|-------|
| `content/pages-registry.ts` | Content | Data | Add pages here |
| `content/nav.ts` | Navigation | Data | Add nav items here |
| `components/*.tsx` | UI Components | React | May need "use client" |
| `app/[...slug]/page.tsx` | Dynamic router | Client | Already correct |

---

## 7. Testing Checklist

Before committing:

```bash
# 1. Check linting
npm run lint

# 2. Check TypeScript
npm run type-check  # if available

# 3. Test in browser
npm run dev
# Visit your changed pages
```

---

## 8. Architecture Decisions

### Why Registry-Based?

- **Pros:** Single source of truth, easy to add content, consistent rendering
- **Cons:** Must transform data, can't use file-based routing directly

### Why Client Components?

- **Pros:** Interactive elements, React hooks, browser APIs
- **Cons:** Larger bundle, can't use server-only features

### Why Next.js 15 use() Hook?

- **Next.js 15 made params async** for better performance
- **Client Components can't be async**, so we use `use()` hook
- **Server Components can await**, but we need client for interactivity

---

## 9. Quick Decision Tree

```
Need to add documentation?
  ‚îî‚îÄ‚Üí Update pages-registry.ts + nav.ts

Need to create a component?
  ‚îî‚îÄ‚Üí Does it use hooks or receive interactive props?
        ‚îú‚îÄ‚Üí YES: Add "use client"
        ‚îî‚îÄ‚Üí NO: Leave as Server Component

Need to handle params?
  ‚îî‚îÄ‚Üí Is it a Client Component?
        ‚îú‚îÄ‚Üí YES: Use use(params)
        ‚îî‚îÄ‚Üí NO: Use await params

Getting an error?
  ‚îî‚îÄ‚Üí Check ARCHITECTURE_PATTERNS.md Common Mistakes section
```

---

## 10. Contact & Support

If you're stuck:

1. Read `ARCHITECTURE_PATTERNS.md` - Common Mistakes section
2. Check `FIXES_LOG.md` - See what was fixed before
3. Look at existing files for patterns
4. Follow the patterns exactly - they exist for a reason!

---

## 11. Version Information

- **Next.js:** 15.5.9
- **React:** 19.x
- **TypeScript:** 5.x
- **Node:** 18+

---

**Remember:** This project has specific patterns that differ from typical Next.js apps. Following this guide prevents wasted time debugging common issues.

**For More Details:** See the comprehensive guides listed at the top of this document.

---

## 12. Recent Changes Log

### January 15, 2026
- ‚úÖ Added Client Component directives
- ‚úÖ Fixed dynamic page rendering
- ‚úÖ Updated setup checklist content
- ‚úÖ Created comprehensive documentation
- ‚úÖ Updated to Next.js 15 patterns

### Future Changes
*Will be logged here as they occur*

---

**End of AI Context File**
